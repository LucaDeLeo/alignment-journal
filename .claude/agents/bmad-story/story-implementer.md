---
name: bmm-story-implementer
description: Implements user stories with tests and validation
model: opus
color: blue
---

# Story Implementer

Execute story implementation by delegating to the BMAD dev-story workflow.

## Inputs

- `story_key`: Story identifier
- `story_file_path`: Path to story markdown
- `review_feedback`: Previous review issues to address (optional, for retry cycles)
- `test_feedback`: Test quality issues to address (optional, from test reviewer)
- `atdd_checklist_path`: Path to ATDD checklist (optional, from test-planner)

## Workflow Reference

Execute the BMAD dev-story workflow:

```
_bmad/bmm/workflows/4-implementation/dev-story/
├── workflow.yaml      # Workflow configuration
├── instructions.xml   # Full execution logic
└── checklist.md       # Definition of done validation
```

**Load and execute:** `_bmad/bmm/workflows/4-implementation/dev-story/instructions.xml`

The workflow handles:
- Loading story file and embedded Dev Notes context
- Loading ATDD checklist if present (tests-first mode)
- Making failing tests pass (GREEN phase of red-green-refactor)
- Running tests incrementally
- Marking tasks complete with evidence
- Updating sprint-status.yaml (ready-for-dev -> in-progress -> review)

## Configuration

Load paths from `_bmad/bmm/config.yaml`:
- `output_folder` -> `_bmad-output/`
- `implementation_artifacts` -> `_bmad-output/implementation-artifacts/`
- `stories_dir` -> `_bmad-output/implementation-artifacts/stories/`
- `tracking_dir` -> `_bmad-output/implementation-artifacts/tracking/`

## Critical Rules

- Story file's Dev Notes section is AUTHORITATIVE
- Execute ALL tasks continuously until complete
- Never mark task complete unless ALL validation gates pass
- HALT if blocked, return blocker_reason

## ATDD Context (Tests-First Mode)

If `atdd_checklist_path` is provided:
- **Tests already exist** - generated by `bmm-story-test-planner` before you
- Your job is the **GREEN phase**: make the failing tests pass
- Read the ATDD checklist for test file locations, AC-to-test mapping, implementation hints
- Do NOT regenerate acceptance tests - they're already scaffolded
- Mark tests as passing incrementally as you implement each AC

## Verification

Run after implementation:
```bash
bun run typecheck && bun run lint && bun run test
```

## Critical Deliverables (MUST DO)

**The story file IS the primary deliverable. You MUST update it:**

1. **Tasks/Subtasks**: Mark each task `[x]` when complete (not before!)
2. **Dev Agent Record -> Completion Notes**: Add implementation summary with key decisions
3. **File List**: Update with ALL new/modified/deleted files (relative paths)
4. **Change Log**: Add entry with date and summary of changes
5. **Status**: Update from `ready-for-dev` -> `review` when all tasks complete

**FAILURE to update the story file = INCOMPLETE WORK, regardless of code changes.**

## Output

Return JSON:

```json
{
  "story_key": "1-1-init-project",
  "story_file_path": "_bmad-output/implementation-artifacts/stories/1-1-init-project.md",
  "story_file_updated": true,
  "story_status": "review",
  "files_modified": ["convex/schema.ts"],
  "files_created": ["convex/entries.ts", "app/routes/index.tsx"],
  "test_files": ["tests/unit/convex/schema.test.ts"],
  "tasks_completed": 6,
  "tasks_total": 6,
  "implementation_summary": "Initialized project structure with Convex schema and basic routing",
  "ac_status": {
    "AC1": "SATISFIED - convex/schema.ts:12",
    "AC2": "SATISFIED - app/routes/index.tsx:1"
  },
  "atdd_tests_passed": ["tests/unit/convex/schema.test.ts:test_schema_valid"],
  "atdd_tests_remaining": []
}
```

**Required fields:**
- `story_file_updated`: MUST be `true`
- `story_status`: MUST be `"review"` when complete (or `"in-progress"` if returning mid-work)

If blocked: include `"blocked": true` and `"blocker_reason": "..."`.
